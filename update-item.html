<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Item - Star Wars Memorabilia Gallery</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="js/updateJSON.js"></script>
    <script src="js/script.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <!-- Admin Auth -->
    <script src="js/admin-auth.js"></script>
    <script>
        // Redirect non-admin users
        if (!window.isAdminMode()) {
            alert("You are not authorized to make updates.");
            window.location.href = "index.html";
        }
    </script>

    <script>
        $(document).ready(function() {
            $("#acquired").datepicker({ dateFormat: "mm/dd/yy" });

            function getQueryParam(name) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(name);
            }

            const itemType = getQueryParam('itemType');
            if (itemType) {
                const jsonFileName = `data/${itemType}.json`;
                $.getJSON(jsonFileName, function(data) {
                    const franchises = [...new Set(data.map(item => item.franchise).filter(Boolean))];
                    franchises.sort();
                    const franchiseDatalist = $('#franchiseList');
                    franchiseDatalist.empty();
                    franchises.forEach(f => franchiseDatalist.append(new Option(f)));

                    const isVerified = [...new Set(data.map(item => item.is_verified).filter(Boolean))];
                    isVerified.sort();
                    const isVerifiedDatalist = $('#isVerifiedList');
                    isVerifiedDatalist.empty();
                    isVerified.forEach(f => isVerifiedDatalist.append(new Option(f)));
                }).fail(function() {
                    alert('Failed to load franchise data.');
                });
            } else {
                alert("itemType query parameter is missing.");
            }
        });
    </script>
</head>
<body>
<header class="d-flex align-items-center justify-content-center py-4">
    <img src="images/GeorgiaJedi-logo-256.jpg" alt="GeorgiaJedi Logo" class="logo mr-3">
    <h1 class="mx-auto">Star Wars Autograph Catalog</h1>
</header>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">GeorgiaJedi</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="autographs.html">Autographs</a></li>
            <li class="nav-item"><a class="nav-link" href="collectibles.html">Collectibles</a></li>
            <li class="nav-item"><a class="nav-link" href="cast.html">Cast/Crew/Characters</a></li>
            <li class="nav-item"><a class="nav-link admin-only" href="add-item.html">Add Item</a></li>
            <li class="nav-item"><a class="nav-link" href="fileuploadtest1.html">Thumb Generator</a></li>
            <li class="nav-item"><a class="nav-link" href="#" id="logoutAdmin" style="display:none;">Logout Admin</a></li>
        </ul>
    </div>
</nav>

<main class="container my-5">
    <h2>Update Memorabilia</h2>
    <form id="dataForm" class="bg-light p-4 rounded shadow row" autocomplete="off">
        <div class="form-group col-md-3">
            <label for="id">ID:</label>
            <input type="text" id="id" name="id" class="form-control" readonly>
        </div>
    
        <div class="form-group col-md-3">
            <label for="title">Name/Title:</label>
            <input type="text" id="title" name="title" class="form-control" required>
        </div>
    
        <div class="form-group col-md-3">
            <label for="franchise">Franchise:</label>
            <input list="franchiseList" id="franchise" name="franchise" class="form-control" required>
            <datalist id="franchiseList"></datalist>
        </div>
    
        <div class="form-group col-md-3">
            <label for="acquired">Acquired Date:</label>
            <input type="text" id="acquired" name="acquired" class="form-control" placeholder="mm/dd/yyyy">
        </div>
    
        <div class="form-group col-md-12">
            <label for="description">Description:</label>
            <textarea id="description" name="description" class="form-control"></textarea>
        </div>
    
        <div class="form-group col-md-3">
            <label for="size">Size:</label>
            <input type="text" id="size" name="size" class="form-control">
        </div>
    
        <div class="form-group col-md-3">
            <label for="source">Source:</label>
            <input type="text" id="source" name="source" class="form-control">
        </div>
    
        <!-- Dropdown for Personalized field -->
        <div class="form-group col-md-3">
            <label for="personalized">Personalized:</label>
            <select id="personalized" name="personalized" class="form-control">
                <option value="">-- Select --</option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
                <option value="N/A">N/A</option>
                <option value="Unknown">Unknown</option>
            </select>
        </div>

        <!-- Combo box for Is Verified field -->
        <div class="form-group col-md-3">
            <label for="is_verified">Is Verified:</label>
            <input list="isVerifiedList" id="is_verified" name="is_verified" class="form-control">
            <datalist id="isVerifiedList"></datalist>
        </div>
    
        <div class="form-group col-md-3">
            <label for="serialnumber">Serial Number:</label>
            <input type="text" id="serialnumber" name="serialnumber" class="form-control">
        </div>
    
        <div class="form-group col-md-3">
            <label for="original_cost">Original Cost:</label>
            <input type="text" id="original_cost" name="original_cost" class="form-control">
        </div>
    
        <div class="form-group col-md-3">
            <label for="current_value">Current Value:</label>
            <input type="text" id="current_value" name="current_value" class="form-control">
        </div>
    
        <div class="form-group col-md-3">
            <label for="image">Image:</label>
            <input type="text" id="image" name="image" class="form-control">
        </div>
    
        <div class="form-group col-md-12">
            <button type="submit" class="btn btn-primary btn-block">Update Item</button>
        </div>
</form>
</main>

<footer class="text-center py-4">
    <p>&copy; 2024 GeorgiaJedi. All rights reserved.</p>
</footer>
</body>
</html>
